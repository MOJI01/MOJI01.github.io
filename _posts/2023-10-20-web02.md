---
layout: post
title: web漏洞02
subtitle: Let's start learning!
tags: [study]
author: Sine
---
### SSRF

服务器请求伪造攻击，实际上就是，后端代码中含有涉及网络访问的危险函数，且未对请求目标进行限制，在参数被攻击者可控的情况下就有可能造成ssrf攻击。

满足两个必要条件：

1、含有涉及网络访问的危险函数

2、攻击者对参数可控

通常，攻击者会利用ssrf漏洞去请求外网不能访问的内网主机或资源，或者通过ssrf读取本地文件。

例如，后端代码中调用了包含可以发起网络请求的函数，且参数是通过get方式传入的能被用户所控的值，后端接收param之后，对这个地址发起请求，读取内容。

```python
param = request.GET.get("param")
def scan(param):
	return urllib.urlopen(param).read()[:50]
scan(param)
```

成功读取到文件

![image-20231019141437775](https://blogandnotebucket.oss-cn-hangzhou.aliyuncs.com/blog/202310191414846.png)





### CSRF

什么是浏览器的同源策略？

同源策略是浏览器的一种安全机制，用于限制不同源之间的资源访问。源是指一个网页的协议、域名和端口号的组合。如果两个网页的源完全相同，那么它们是同源的，可以互相访问资源。如果两个网页的源有任何一个不同，那么它们是不同源的，不能互相访问资源，除非使用一些特殊的方法。

网页在发起请求时，浏览器会先发起一个跨域请求，请求源会在返回中带上允许请求的源来告知浏览器，该源是否允许请求目标源。

csrf就是利用浏览器的同源策略，当ab属于同源，从a站点访问c，c会对b发起请求，这时候这个请求就会被认为和b站点同源，浏览器会带上cookie进行请求，当c中的请求包含一些恶意操作时，就会造成csrf攻击。

网上很多csrf的防御手法中会有，设置同源规则，在请求头上加入origion、referer等字段，这其实并不能从根本上进行防御，因为这是由浏览器加上的，拦截浏览器发出的包，照样能对这些字段进行伪造。同样只使用cookie进行身份验证也是不安全的，在请求网站时，浏览器会根据域名在缓存中查找对应的cookie并把他加到请求头中，那加上token为什么能实现防御呢？

因为token是在前端代码中加到请求包中的。



